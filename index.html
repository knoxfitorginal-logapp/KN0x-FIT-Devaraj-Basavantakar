<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KN0X-FIT Interactive Diet Plan</title>
    <!-- Chosen Palette: Cool Gray & Slate Blue -->
    <!-- Application Structure Plan: A dashboard-style SPA with a main overview and tabbed navigation for each of the 4 weeks, a new "Key Notes" section, a new "Training Plan" section, and a final "Explore" page. The user flow is: Overview -> Select Week -> View Daily Meals -> Read Key Notes -> View Training Plan -> Explore other services. -->
    <!-- Visualization & Content Choices: 1. Client Metrics (BMI/BMR/TDEE): Goal=Inform, Method=Styled HTML cards with a CSS bar for BMI, Interaction=None, Justification=Clear, static display of core data. 2. Macro Split: Goal=Inform, Method=Donut Chart, Interaction=Hover for tooltips, Justification=Visually represents dietary proportions effectively, Library=Chart.js. 3. Weekly Plans: Goal=Organize/Inform, Method=Tabs with meal cards, Interaction=Click tabs to switch weeks. 4. Key Notes: Goal=Educate/Inform, Method=Grid of stylized cards with icons and text, Interaction=None, Justification=Breaks down complex information into digestible, easy-to-scan sections. 5. Explore Page: Goal=Engage/Inform/Convert, Method=Styled cards with plan details and interactive contact links, Interaction=Clickable links to social media and contact info. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    
    <!-- SPEED OPTIMIZATION: Preconnect to external domains -->
    <!-- FIX: Corrected markdown-style links -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="preconnect" href="https://cdnjs.cloudflare.com">

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- SPEED OPTIMIZATION: Chart.js moved to end of body -->
    
    <!-- SPEED OPTIMIZATION: Asynchronously load render-blocking CSS -->
    <!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"> -->
    <link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"></noscript>
    
    <!-- <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet"> -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap"></noscript>
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f2f5;
        }
        .nav-link {
            transition: all 0.3s ease;
        }
        .nav-link.active {
            background-color: #4f46e5;
            color: white;
            font-weight: 600;
        }
        /* Add active state for mobile tap feedback */
        .nav-link:active, .mobile-menu-toggle:active, .week-tracker-btn:active {
            transform: scale(0.95);
        }
        /* SPEED OPTIMIZATION: Faster, smoother animation */
        .content-fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        .collapsible-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease-in-out;
        }
        .collapsible-content.expanded {
            max-height: 500px; /* Adjust as needed */
        }
        .collapsible-header i {
            transition: transform 0.3s ease-in-out;
        }
        .collapsible-header.expanded i {
            transform: rotate(180deg);
        }
        /* Mobile scroll hint for workout tables */
        .scroll-hint {
            display: none;
        }
        .workout-table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }
        .workout-table {
            min-width: 700px; /* Force table to be wide */
        }
        @media (max-width: 768px) {
            .workout-table-wrapper {
                position: relative;
            }
            .scroll-hint {
                display: block;
                position: absolute;
                top: 50%;
                right: 10px;
                transform: translateY(-50%);
                background-color: rgba(79, 70, 229, 0.8);
                color: white;
                padding: 4px 8px;
                border-radius: 99px;
                font-size: 0.75rem;
                font-weight: 600;
                pointer-events: none; /* Don't block clicks on the table */
                animation: pulse 1.5s infinite ease-in-out;
            }
            @keyframes pulse {
                0%, 100% { opacity: 0.9; }
                50% { opacity: 0.4; }
            }
        }
        
    </style>
</head>
<body class="text-gray-800">

    <!-- Mobile Header -->
    <div id="mobile-header-bar" class="lg:hidden bg-white shadow-md p-2 flex justify-between items-center sticky top-0 z-30">
        <button id="mobile-menu-toggle" class="mobile-menu-toggle text-indigo-600 text-2xl active:scale-95 transition-transform p-2">
            <i class="fa-solid fa-bars"></i>
        </button>
        <!-- Logo with local path -->
        <img src="./src/assets/final_logo-removebg-preview (1).png" 
             alt="KN0X-FIT Logo" 
             class="h-14 w-auto">
        <div class="w-10"></div> <!-- Spacer -->
    </div>

    <!-- Mobile Overlay -->
    <div id="mobile-overlay" class="lg:hidden fixed inset-0 bg-black bg-opacity-50 z-10 hidden transition-opacity"></div>

    <!-- Layout Container -->
    <div class="relative min-h-screen lg:flex">
        <!-- Sidebar Navigation -->
        <aside id="sidebar" class="bg-white w-64 p-4 lg:p-6 shadow-md fixed top-0 left-0 h-full z-20 transform -translate-x-full transition-transform lg:translate-x-0 lg:relative lg:flex-shrink-0 lg:shadow-lg overflow-y-auto">
            <div class="flex items-center justify-center mb-8 w-full">
                <!-- Logo with local path -->
                <img src="./src/assets/final_logo-removebg-preview (1).png" 
                     alt="KN0X-FIT Logo" 
                     class="h-20 md:h-24 w-auto">
            </div>
            <nav id="navigation" class="space-y-2">
                <a href="#" data-view="dashboard" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-gauge-high w-5"></i> Dashboard
                </a>
                <a href="#" data-view="week1" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-calendar-day w-5"></i> Week 1
                </a>
                <a href="#" data-view="week2" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-calendar-week w-5"></i> Week 2
                </a>
                <a href="#" data-view="week3" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-calendar-alt w-5"></i> Week 3
                </a>
                <a href="#" data-view="week4" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-calendar w-5"></i> Week 4
                </a>
                <a href="#" data-view="keyNotes" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-clipboard-list w-5"></i> Key Notes
                </a>
                <!-- Training Plan Collapsible Menu -->
                <div class="relative">
                    <button id="training-plan-toggle" class="nav-link w-full flex items-center justify-between gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                        <span class="flex items-center gap-3">
                            <i class="fa-solid fa-dumbbell w-5"></i> Training Plan
                        </span>
                        <i class="fa-solid fa-chevron-down text-xs transition-transform"></i>
                    </button>
                    <div id="training-plan-submenu" class="collapsible-content pl-6 space-y-1 pt-1">
                        <a href="#" data-view="training-summary" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 text-sm">Summary</a>
                        <a href="#" data-view="training-day-0" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 text-sm">Day 1: Monday</a>
                        <a href="#" data-view="training-day-1" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 text-sm">Day 2: Tuesday</a>
                        <a href="#" data-view="training-day-2" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 text-sm">Day 3: Wednesday</a>
                        <a href="#" data-view="training-day-3" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 text-sm">Day 4: Thursday</a>
                        <a href="#" data-view="training-day-4" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 text-sm">Day 5: Friday</a>
                        <a href="#" data-view="training-day-5" class="nav-link flex items-center gap-3 px-4 py-2 rounded-lg text-gray-600 hover:bg-indigo-50 text-sm">Day 6: Saturday</a>
                    </div>
                </div>
                <a href="#" data-view="explore" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-rocket w-5"></i> Explore
                </a>
                <a href="#" data-view="terms" class="nav-link flex items-center gap-3 px-4 py-2.5 rounded-lg text-gray-600 hover:bg-indigo-50">
                    <i class="fa-solid fa-file-shield w-5"></i> T&C
                </a>
            </nav>
        </aside>

        <!-- Main Content Area -->
        <main id="main-content" class="flex-1 p-4 sm:p-6 lg:p-8 transition-all overflow-y-auto">
            <!-- Content will be injected here -->
        </main>
    </div>

    <!-- SPEED OPTIMIZATION: Moved Chart.js to the end of body and added 'defer' -->
    <!-- FIX: Corrected markdown-style links -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>

    <script>
        const dietPlanData = {
            client: {
                name: "Devaraj Basavantakar",
                goal: "Fat Loss (Obesity Class I)",
                age: 24,
                gender: "Male",
                currentWeight: "93 kg",
                bmr: 1900.85,
                bmi: 30.81,
                tdee: 3278.97,
                calorieTarget: 2600,
                dietaryPreference: "Non-Vegetarian",
                activityLevel: "Intense exercise 6-7 times/week"
            },
            // NEW macros: ~2600 kcal | P: 158g (24%) | F: 90g (31%) | C: 290g (45%)
            weeks: {
                week1: {
                    title: "Week 1: Foundation and Portion Control",
                    focus: "This plan establishes the caloric deficit and portion control, maximizing protein intake from lean sources.",
                    meals: [
                        {
                            time: "Breakfast",
                            icon: "fa-solid fa-sun",
                            items: [
                                { name: "Ragi Dosa", quantity: "3 medium", link: "Ragi Dosa recipe south indian" },
                                { name: "Chicken Curry", quantity: "120g cooked lean breast", link: "Chicken Curry recipe south indian" },
                                { name: "Coconut/Peanut Chutney", quantity: "2.5 tbsp", link: "Peanut Chutney recipe south indian" },
                            ],
                            macros: "P: 42g, F: 30g, C: 70g (~718 kcal)",
                            micros: "Iron, Calcium (from Ragi), Fiber, B Vitamins, Niacin, Healthy Fats, Manganese",
                            color: "bg-orange-100",
                            alternative: "Ragi Mudde (2 medium balls) + Chicken Curry (120g)"
                        },
                        {
                            time: "Lunch",
                            icon: "fa-solid fa-utensils",
                            items: [
                                { name: "Brown Rice/Parboiled Rice/White Rice", quantity: "2.5 cups cooked", link: "how to cook Brown Rice" },
                                { name: "Tawa-fried Fish", quantity: "150g (Kingfish/Surmai, minimal oil)", link: "Tawa-fried Fish recipe south indian" },
                                { name: "Vegetable Stir-Fry", quantity: "1 bowl (e.g., green beans, carrots)", link: "Vegetable Stir-Fry recipe south indian" }
                            ],
                            macros: "P: 47g, F: 27g, C: 100g (~831 kcal)",
                            micros: "Omega-3 Fatty Acids, Vitamin D, Magnesium, Selenium, Vitamin A/C/K",
                            color: "bg-green-100",
                            alternative: "Easy Chicken Pepper Fry (150g) + 2.5 cups Brown Rice or 5-6 Chapatis"
                        },
                        {
                            time: "Dinner",
                            icon: "fa-solid fa-moon",
                            items: [
                                { name: "Whole Wheat Chapati/Roti", quantity: "4-5 medium", link: "Whole Wheat Roti recipe" },
                                { name:"Egg Bhurji/Scramble", quantity: "3 whole eggs + 3 whites", link: "Egg Bhurji recipe" },
                                { name: "Sambar/Rasam", quantity: "1 large bowl (with extra lentils)", link: "Sambar recipe south indian" }
                            ],
                            macros: "P: 69g, F: 33g, C: 120g (~1053 kcal)",
                            micros: "Folic Acid, Potassium, Whole Grain Fiber, Vitamin B6, Choline, Complete Protein",
                            color: "bg-blue-100",
                            alternative: "Ragi Mudde (2 balls) + Egg Curry (3 eggs)"
                        },
                        { 
                            time: "Total Daily Intake", 
                            icon: "fa-solid fa-calculator",
                            item: "~2602 kcal | Protein: ~158g, Fat: ~90g, Carbs: ~290g", 
                            macros: "", 
                            micros: "Excellent adherence to macro targets. Ensure 3-4 liters of water.", 
                            color: "bg-indigo-100" 
                        }
                    ]
                },
                week2: {
                    title: "Week 2: Introducing Legumes and Variety",
                    focus: "Replacing some meat/fish with vegetarian protein sources (paneer, legumes) to increase fiber and micronutrient diversity.",
                    meals: [
                        {
                            time: "Breakfast",
                            icon: "fa-solid fa-sun",
                            items: [
                                { name: "Idli", quantity: "4 medium", link: "Idli recipe south indian" },
                                { name: "Tawa-Fried / Boiled Eggs", quantity: "3 whole eggs", link: "Tawa-Fried Eggs recipe" },
                                { name: "Nandini Curd", quantity: "250ml", link: "how to make curd" },
                                { name: "Tomato/Onion Chutney", quantity: "2 tbsp", link: "Tomato Onion Chutney recipe south indian" }
                            ],
                            macros: "P: 43g, F: 25g, C: 70g (~677 kcal)",
                            micros: "Probiotics, B Vitamins, Lycopene, Vitamin C, Complete Protein",
                            color: "bg-orange-100",
                            alternative: "3-Egg Omelette + 3 slices Whole Wheat Bread + 1 glass Milk"
                        },
                        {
                            time: "Lunch",
                            icon: "fa-solid fa-utensils",
                            items: [
                                { name: "Vegetable Biryani", quantity: "3 cups (Less oil, extra veggies)", link: "Vegetable Biryani recipe south indian" },
                                { name: "Tawa-fried Paneer / Chicken", quantity: "150g Paneer or 120g Chicken", link: "Tawa-fried Paneer recipe" },
                                { name: "Raita/Curd", quantity: "1 bowl (with cucumber)", link: "Raita recipe" }
                            ],
                            macros: "P: 55g, F: 27g, C: 100g (~863 kcal)",
                            micros: "Zinc, Potassium, B Vitamins, Calcium, Casein Protein, Probiotics, Hydration",
                            color: "bg-green-100",
                            alternative: "Paneer Tikka (150g) + 2 Multigrain Rotis + Salad"
                        },
                        {
                            time: "Dinner",
                            icon: "fa-solid fa-moon",
                            items: [
                                { name: "Chicken Breast", quantity: "80g cooked", link: "Grilled Chicken Breast recipe" },
                                { name: "Brown Rice / Chapati", quantity: "2.5 cups cooked Rice or 5-6 Chapatis", link: "how to cook Brown Rice" },
                                { name: "Daal Tadka", quantity: "1.5 bowls (Split yellow lentils)", link: "Daal Tadka recipe" },
                                { name: "Cucumber and Carrot Salad", quantity: "1 large bowl", link: "Cucumber and Carrot Salad recipe" }
                            ],
                            macros: "P: 60g, F: 38g, C: 120g (~1062 kcal)",
                            micros: "Lean Protein, Magnesium, Vitamin K, Hydration, Fiber",
                            color: "bg-blue-100",
                            alternative: "Fish Curry (120g) + 3 Chapatis + Dal"
                        },
                        { 
                            time: "Total Daily Intake", 
                            icon: "fa-solid fa-calculator",
                            item: "~2602 kcal | Protein: ~158g, Fat: ~90g, Carbs: ~290g", 
                            macros: "", 
                            micros: "Great variety. The paneer and curd provide excellent calcium.", 
                            color: "bg-indigo-100" 
                        }
                    ]
                },
                week3: {
                    title: "Week 3: Fiber Boost and Nutrient Density",
                    focus: "Incorporating more whole legumes and high-fiber grains to improve satiety and digestive health.",
                     meals: [
                        {
                            time: "Breakfast",
                            icon: "fa-solid fa-sun",
                            items: [
                                { name: "Oats with Banana & Dry Fruits", quantity: "50g oats, 1 banana, 15g dry fruits", link: "Oats with banana and dry fruits recipe" },
                                { name: "Whole Eggs", quantity: "3 (boiled or scrambled)", link: "boiled eggs" },
                                { name: "Jowar Roti", quantity: "2 medium", link: "Jowar Roti recipe" }
                            ],
                            macros: "P: 43g, F: 25g, C: 70g (~677 kcal)",
                            micros: "High Fiber, Potassium, Healthy Fats, Choline, Vitamin D, Manganese",
                            color: "bg-orange-100",
                            alternative: "Protein Shake + 3-Egg Scramble + 2 slices Toast"
                        },
                        {
                            time: "Lunch",
                            icon: "fa-solid fa-utensils",
                            items: [
                                { name: "Barley/Jowar Roti", quantity: "3 medium", link: "Jowar Roti recipe" },
                                { name: "South Indian Pepper Chicken", quantity: "150g cooked (lean breast)", link: "South Indian Pepper Chicken recipe" },
                                { name: "Green Salad", quantity: "1 large bowl (Onion, tomato, cucumber)", link: "Green Salad recipe" }
                            ],
                            macros: "P: 47g, F: 27g, C: 100g (~831 kcal)",
                            micros: "High Fiber, Manganese, Phosphorus, Potassium, Lean Protein, Vitamin C, Hydration",
                            color: "bg-green-100",
                            alternative: "150g Grilled Chicken + 2.5 cups Brown Rice + Salad"
                        },
                        {
                            time: "Dinner",
                            icon: "fa-solid fa-moon",
                            items: [
                                { name: "Whole Wheat Roti", quantity: "3 medium", link: "Whole Wheat Roti recipe" },
                                { name: "Channa Masala", quantity: "2 bowls (Chickpea curry)", link: "Channa Masala recipe" },
                                { name: "Full-fat Curd", quantity: "1.5 cups", link: "how to make curd" }
                            ],
                            macros: "P: 68g, F: 38g, C: 120g (~1094 kcal)",
                            micros: "Fiber, B Vitamins, Plant-based Protein, Iron, Zinc, Calcium, Probiotics",
                            color: "bg-blue-100",
                            alternative: "Paneer Bhurji (120g) + 3 Rotis + Salad"
                        },
                        { 
                            time: "Total Daily Intake", 
                            icon: "fa-solid fa-calculator",
                            item: "~2602 kcal | Protein: ~158g, Fat: ~90g, Carbs: ~290g", 
                            macros: "", 
                            micros: "High fiber intake this week will aid digestion and satiety.", 
                            color: "bg-indigo-100" 
                        }
                    ]
                },
                week4: {
                    title: "Week 4: Maximizing Lean Protein",
                    focus: "Maintaining high protein and fiber while managing starches, preparing the body for a maintenance phase.",
                    meals: [
                        {
                            time: "Breakfast",
                            icon: "fa-solid fa-sun",
                            items: [
                                { name: "Upma (Semolina)", quantity: "2 cups cooked", link: "Upma recipe south indian" },
                                { name: "Sprouts Salad", quantity: "1 cup (Mixed bean sprouts)", link: "Sprouts Salad recipe" },
                                { name: "Scrambled Egg Whites", quantity: "6 egg whites", link: "Scrambled Egg Whites recipe" }
                            ],
                            macros: "P: 43g, F: 28g, C: 70g (~704 kcal)",
                            micros: "Iron, Quick Energy, Vitamin C, Live Enzymes, Pure Protein",
                            color: "bg-orange-100",
                            alternative: "Protein Shake + 4 Boiled Egg Whites + 1 Apple"
                        },
                        {
                            time: "Lunch",
                            icon: "fa-solid fa-utensils",
                            items: [
                                { name: "Parboiled Rice / Chapati", quantity: "2.5 cups cooked Rice or 5-6 Chapatis", link: "how to cook Parboiled Rice" },
                                { name: "Grilled Chicken/Tofu Masala", quantity: "150g (no added oil)", link: "Grilled Chicken Masala recipe" },
                                { name: "Rasam", quantity: "1 large bowl (Clear, light soup)", link: "Rasam recipe south indian" }
                            ],
                            macros: "P: 47g, F: 27g, C: 100g (~831 kcal)",
                            micros: "Potassium, B Vitamins, High Quality Protein, Selenium, Digestion, Hydration",
                            color: "bg-green-100",
                            alternative: "Chicken Salad (150g) + 2.5 cups Pasta"
                        },
                        {
                            time: "Dinner",
                            icon: "fa-solid fa-moon",
                            items: [
                                { name: "Plain Ragi Dosa", quantity: "3 medium", link: "Ragi Dosa recipe south indian" },
                                { name: "Palak Daal", quantity: "2 bowls (Spinach and Lentil Curry)", link: "Palak Daal recipe" },
                                { name: "Side of low-fat yogurt", quantity: "1.5 cups", link: "how to make curd" }
                            ],
                            macros: "P: 68g, F: 35g, C: 120g (~1067 kcal)",
                            micros: "Balanced Carb/Protein, Calcium, Iron, Vitamin A, Probiotics",
                            color: "bg-blue-100",
                            alternative: "Soya Chunks Curry (60g dry) + 3 Chapatis"
                        },
                        { 
                            time: "Total Daily Intake", 
                            icon: "fa-solid fa-calculator",
                            item: "~2602 kcal | Protein: ~158g, Fat: ~90g, Carbs: ~290g", 
                            macros: "", 
                            micros: "Final push week. Protein intake is high to preserve muscle during the cut.", 
                            color: "bg-indigo-100" 
                        }
                    ]
                }
            }
        };

        const trainingPlanData = {
            summary: {
                title: "6-Day High-Frequency Workout Plan",
                keyFocus: "Progressive Overload",
                keyFocusNote: "Track every set. Each week, aim to add 1.25kg, one extra rep, or do the same work in less time.",
                schedule: [
                    { day: "Day 1: Monday", focus: "PUSH A (Chest, Shoulders, Triceps)", goal: "Strength, Calorie Burn", cardio: "15 min LISS Post-Workout" },
                    { day: "Day 2: Tuesday", focus: "PULL A (Back, Biceps, Traps)", goal: "Strength, Calorie Burn", cardio: "15 min LISS Post-Workout" },
                    { day: "Day 3: Wednesday", focus: "LEGS A (Quads Focus)", goal: "Strength, Metabolic Conditioning", cardio: "20 min HIIT Post-Workout" },
                    { day: "Day 4: Thursday", focus: "PUSH B (Shoulders, Chest, Triceps)", goal: "Volume, Hypertrophy", cardio: "15 min LISS Post-Workout" },
                    { day: "Day 5: Friday", focus: "PULL B (Back Thickness, Biceps)", goal: "Volume, Hypertrophy", cardio: "15 min LISS Post-Workout" },
                    { day: "Day 6: Saturday", focus: "LEGS B (Hamstring/Glute Focus)", goal: "Volume, Core Strength", cardio: "20 min HIIT Post-Workout" },
                    { day: "Day 7: Sunday", focus: "REST", goal: "Active Recovery (Walking/Stretching)", cardio: "Optional: Light Walk 30 min" }
                ],
                // UPDATED: Added more recovery notes
                recoveryNote: "Given the intensity of this 6-day plan and the caloric deficit, <strong>7-8 hours of sleep</strong> and adherence to the <strong>~158g protein</strong> diet plan are absolutely critical for rapid, safe results. <br><br><strong>Additional Notes:</strong><br> - Listen to your body. If you feel excessive fatigue or pain (not just soreness), take an extra rest day.<br> - Stay hydrated. Drink water consistently throughout the day, especially on training days.<br> - Consider light stretching or foam rolling on your rest day (Day 7) to aid muscle recovery."
            },
            detailedStructure: {
                sets: "3 sets for all exercises unless otherwise noted.",
                rest: "60-90 seconds between sets.",
                days: [
                    {
                        title: "Day 1: PUSH A (Strength)",
                        dayName: "Monday",
                        exercises: [
                            { name: "Warm-up", sets: "5 min", reps: "Dynamic Stretching", focus: "Arm Circles, Shoulder Rotations.", note: "" },
                            { name: "Dumbbell Bench Press", sets: "3", reps: "8-10", focus: "Compound/Chest", note: "Focus on controlling the negative (lowering) phase." },
                            { name: "Seated Dumbbell Overhead Press", sets: "3", reps: "10-12", focus: "Shoulders", note: "Keep your lower back pressed against the bench." },
                            { name: "Incline Dumbbell Press", sets: "3", reps: "10-12", focus: "Upper Chest", note: "Use a moderate incline." },
                            { name: "Lateral Raises", sets: "3", reps: "12-15", focus: "Side Shoulders", note: "Use a lighter weight; focus on mind-muscle connection." },
                            { name: "Cable Triceps Pushdown", sets: "3", reps: "10-12", focus: "Triceps", note: "Use rope attachment; squeeze at the bottom." },
                            { name: "Core: Plank", sets: "3", reps: "60 sec", focus: "Core Stability", note: "Focus on squeezing glutes and bracing the core." },
                            { name: "Cardio", sets: "15 min", reps: "LISS", focus: "Post-Lift Walk/Elliptical", note: "Maintain 120-130 BPM." }
                        ]
                    },
                    {
                        title: "Day 2: PULL A (Strength)",
                        dayName: "Tuesday",
                        exercises: [
                            { name: "Warm-up", sets: "5 min", reps: "Dynamic Stretching", focus: "Cat-cow, Shoulder Dislocations.", note: "" },
                            { name: "Dumbbell Rows (per arm)", sets: "3", reps: "8-10", focus: "Back Thickness", note: "Pull the elbow back towards your hip." },
                            { name: "Lat Pulldown", sets: "3", reps: "10-12", focus: "Back Width", note: "Squeeze shoulder blades down and back." },
                            { name: "Face Pulls", sets: "3", reps: "15", focus: "Rear Delt/Posture", note: "Crucial for shoulder health." },
                            { name: "Dumbbell Shrugs", sets: "3", reps: "15", focus: "Traps", note: "Full range of motion." },
                            { name: "Dumbbell Bicep Curls", sets: "3", reps: "10-12", focus: "Biceps", note: "Alternate arms, keep the curl controlled." },
                            { name: "Core: Russian Twists", sets: "3", reps: "15 per side", focus: "Obliques", note: "Use a light dumbbell/plate if possible." },
                            { name: "Cardio", sets: "15 min", reps: "LISS", focus: "Post-Lift Walk/Elliptical", note: "Maintain 120-130 BPM." }
                        ]
                    },
                    {
                        title: "Day 3: LEGS A (Quads Focus + HIIT)",
                        dayName: "Wednesday",
                        exercises: [
                            { name: "Warm-up", sets: "5 min", reps: "Dynamic Stretching", focus: "Leg Swings, Bodyweight Squats.", note: "" },
                            { name: "Barbell Squats", sets: "3", reps: "10-12", focus: "Compound/Quads", note: "Focus on form: back straight, chest up, squat deep." },
                            { name: "Dumbbell Romanian Deadlifts (RDLs)", sets: "3", reps: "10-12", focus: "Hamstrings/Glutes", note: "Focus on a deep stretch in the hamstrings." },
                            { name: "Walking Lunges", sets: "3", reps: "10 per leg", focus: "Quads/Glutes", note: "Focus on balance and knee over ankle." },
                            { name: "Leg Extensions", sets: "3", reps: "12-15", focus: "Quads Isolation", note: "Squeeze at the top for 1 second." },
                            { name: "Seated Calf Raises", sets: "4", reps: "15", focus: "Calves", note: "Slow and controlled." },
                            { name: "Cardio", sets: "20 min", reps: "HIIT", focus: "Metabolic Conditioning", note: "Sprint/Cycle 30 sec, Rest 60 sec. Repeat 12-15 times." }
                        ]
                    },
                    {
                        title: "Day 4: PUSH B (Volume)",
                        dayName: "Thursday",
                        exercises: [
                            { name: "Warm-up", sets: "5 min", reps: "Dynamic Stretching", focus: "", note: "" },
                            { name: "Push-ups (or Machine Chest Press)", sets: "3", reps: "AMRAP (or 15)", focus: "Chest", note: "AMRAP = As Many Reps As Possible." },
                            { name: "Seated Dumbbell Press (Lighter weight)", sets: "3", reps: "12-15", focus: "Shoulders", note: "Higher reps for muscle endurance." },
                            { name: "Cable Flyes (Low pulley)", sets: "3", reps: "15", focus: "Lower/Inner Chest", note: "Focus on crossing hands slightly at the peak." },
                            { name: "Reverse Pec Deck Flyes", sets: "3", reps: "15", focus: "Rear Delts", note: "Great isolation for posture." },
                            { name: "Overhead Dumbbell Extension", sets: "3", reps: "12-15", focus: "Triceps Long Head", note: "Focus on a deep stretch." },
                            { name: "Core: Side Plank", sets: "3", reps: "45 sec per side", focus: "Obliques", note: "" },
                            { name: "Cardio", sets: "15 min", reps: "LISS", focus: "Post-Lift Walk/Elliptical", note: "" }
                        ]
                    },
                    {
                        title: "Day 5: PULL B (Volume)",
                        dayName: "Friday",
                        exercises: [
                            { name: "Warm-up", sets: "5 min", reps: "Dynamic Stretching", focus: "", note: "" },
                            { name: "Seated Cable Row (Close grip)", sets: "3", reps: "12-15", focus: "Back Thickness", note: "Emphasize the squeeze in the mid-back." },
                            { name: "Straight-Arm Pulldowns", sets: "3", reps: "15", focus: "Lats (Width)", note: "Keep arms straight, focus on contracting the lats." },
                            { name: "Machine T-Bar Row (or Bench Supported Row)", sets: "3", reps: "10-12", focus: "Mid-Back", note: "Keep back flat." },
                            { name: "Hammer Curls", sets: "3", reps: "10-12", focus: "Forearms/Biceps", note: "Use a neutral grip." },
                            { name: "Reverse Dumbbell Curls", sets: "3", reps: "15", focus: "Forearms", note: "Good for grip strength." },
                            { name: "Core: Crunches", sets: "3", reps: "20", focus: "Upper Abs", note: "Controlled movement." },
                            { name: "Cardio", sets: "15 min", reps: "LISS", focus: "Post-Lift Walk/Elliptical", note: "" }
                        ]
                    },
                    {
                        title: "Day 6: LEGS B (Hamstring/Glute Focus + HIIT)",
                        dayName: "Saturday",
                        exercises: [
                            { name: "Warm-up", sets: "5 min", reps: "Dynamic Stretching", focus: "", note: "" },
                            { name: "Leg Press (High foot placement)", sets: "3", reps: "10-12", focus: "Glutes/Hams", note: "High foot placement emphasizes posterior chain." },
                            { name: "Seated/Lying Leg Curls", sets: "3", reps: "12-15", focus: "Hamstring Isolation", note: "Slow eccentric (lowering) phase." },
                            { name: "Dumbbell Step-ups", sets: "3", reps: "10 per leg", focus: "Glutes", note: "Use a secure box/bench; drive through the heel." },
                            { name: "Leg Extensions (lighter weight)", sets: "3", reps: "15-20", focus: "Quads (Pump)", note: "Focus on high reps for a metabolic burn." },
                            { name: "Standing Calf Raises", sets: "4", reps: "15", focus: "Calves", note: "Full stretch at the bottom." },
                            { name: "Cardio", sets: "20 min", reps: "HIIT", focus: "Metabolic Conditioning", note: "Sprint/Cycle 30 sec, Rest 60 sec. Repeat 12-15 times." }
                        ]
                    }
                ]
            }
        };

        const bmiData = [
            { label: 'Underweight', range: '< 18.5', color: 'bg-blue-400', risk: 'Potential nutritional deficiencies, osteoporosis, weakened immune system.' },
            { label: 'Normal', range: '18.5 - 24.9', color: 'bg-green-400', risk: 'Generally considered healthy, lowest risk for major diseases.' },
            { label: 'Overweight', range: '25.0 - 29.9', color: 'bg-yellow-400', risk: 'Increased risk of heart disease, type 2 diabetes, and high blood pressure.' },
            { label: 'Obese', range: '30.0+', color: 'bg-red-400', risk: 'High risk of heart disease, stroke, diabetes, certain cancers, and joint problems.' }
        ];

        const mainContent = document.getElementById('main-content');
        const navigation = document.getElementById('navigation');
        const sidebar = document.getElementById('sidebar');
        const menuToggle = document.getElementById('mobile-menu-toggle');
        const overlay = document.getElementById('mobile-overlay');
        const trainingPlanToggle = document.getElementById('training-plan-toggle');
        const trainingPlanSubmenu = document.getElementById('training-plan-submenu');

        let macroChart = null;

        function renderDashboard() {
            const { client } = dietPlanData;
            
            mainContent.innerHTML = `
                <div class="content-fade-in">
                    <h2 id="dashboard-h2" class="text-3xl font-bold text-gray-900 mb-2">Welcome to <a href="https-kn0x-fit.com-" target="_blank" class="text-red-500 hover:underline">KN0X-FIT</a>, ${client.name}!</h2>
                    <p class="text-gray-600 mb-8">Your personalized <strong>${client.goal}</strong> plan is ready. Let's get started on your transformation!</p>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
                        <div class="bg-white p-6 rounded-xl shadow-sm flex items-center gap-4"><i class="fa-solid fa-weight-scale text-3xl text-red-500"></i><div><p class="text-sm text-gray-500">BMI</p><p class="text-3xl font-bold">${client.bmi}</p><p class="font-semibold text-red-500">Obese Class I</p></div></div>
                        <div class="bg-white p-6 rounded-xl shadow-sm flex items-center gap-4"><i class="fa-solid fa-fire text-3xl text-orange-500"></i><div><p class="text-sm text-gray-500">BMR</p><p class="text-3xl font-bold">${client.bmr.toFixed(0)} <span class="text-base font-normal">kcal</span></p></div></div>
                        <div class="bg-white p-6 rounded-xl shadow-sm flex items-center gap-4"><i class="fa-solid fa-person-running text-3xl text-yellow-500"></i><div><p class="text-sm text-gray-500">TDEE</p><p class="text-3xl font-bold">${client.tdee.toFixed(0)} <span class="text-base font-normal">kcal</span></p></div></div>
                        <div class="bg-white p-6 rounded-xl shadow-sm border-2 border-indigo-600 flex items-center gap-4"><i class="fa-solid fa-bullseye text-3xl text-indigo-600"></i><div><p class="text-sm text-gray-500">Daily Target</p><p class="text-3xl font-bold text-indigo-600">${client.calorieTarget} <span class="text-base font-normal">kcal</span></p></div></div>
                    </div>

                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
                        <div class="bg-white p-6 rounded-xl shadow-sm">
                            <h3 class="text-xl font-bold mb-4">Client Information</h3>
                            <ul class="space-y-2 text-gray-700">
                                <li><strong>Name:</strong> ${client.name}</li>
                                <li><strong>Age:</strong> ${client.age}</li>
                                <li><strong>Current Weight:</strong> ${client.currentWeight}</li>
                                <li><strong>Primary Goal:</strong> ${client.goal}</li>
                                <li><strong>Dietary Preference:</strong> ${client.dietaryPreference}</li>
                                <li><strong>Activity Level:</strong> ${client.activityLevel}</li>
                            </ul>
                        </div>
                        <div class="bg-white p-6 rounded-xl shadow-sm">
                            <h3 class="text-xl font-bold mb-4">Daily Macronutrient Goals</h3>
                            <!-- Skeleton Loader (Visible immediately) -->
                            <div id="chart-skeleton" class="chart-container h-64 max-h-64 mx-auto max-w-xs flex flex-col items-center justify-center space-y-3 p-4 bg-gray-50 rounded-lg animate-pulse">
                                <div class="w-3/4 h-3 bg-gray-300 rounded"></div>
                                <div class="w-full h-40 bg-gray-300 rounded-full"></div>
                                <div class="w-1/2 h-3 bg-gray-300 rounded"></div>
                            </div>
                            <!-- Actual Chart (Hidden initially) -->
                            <div id="chart-wrapper" class="chart-container h-64 max-h-64 mx-auto max-w-xs hidden">
                                <canvas id="macroChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm">
                        <h3 class="text-xl font-bold mb-4">Understanding Your BMI</h3>
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                            ${bmiData.map(item => `
                                <div class="p-4 rounded-lg border border-gray-200">
                                    <div class="flex items-center mb-2">
                                        <div class="w-4 h-4 rounded-full ${item.color} mr-2"></div>
                                        <p class="font-bold">${item.label}</p>
                                    </div>
                                    <p class="text-sm text-gray-600"><strong>Range:</strong> ${item.range}</p>
                                    <p class="text-sm text-gray-500 mt-2">${item.risk}</p>
                                </div>
                            `).join('')}
                        </div>
                        <div class="mt-6">
                            <h4 class="font-bold text-lg mb-2">Your BMI: ${client.bmi} (Obese Class I)</h4>
                            <div class="w-full bg-gray-200 rounded-full h-4 overflow-hidden">
                                <div class="h-4 rounded-full ${client.bmi < 18.5 ? 'bg-blue-400' : (client.bmi < 25 ? 'bg-green-400' : (client.bmi < 30 ? 'bg-yellow-400' : 'bg-red-400'))}" style="width: ${Math.min(100, (client.bmi / 40) * 100)}%;"></div>
                            </div>
                            <div class="flex justify-between text-xs mt-1 text-gray-600">
                                <span>18.5</span>
                                <span>25</span>
                                <span>30</span>
                                <span>40+</span>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            initMacroChart(); // Call the new initialization function
        }

        // Renamed function to focus purely on chart instantiation
        function _createChartInstance() {
            // NEW Targets: ~2600 kcal | P: 158g (24%) | F: 90g (31%) | C: 290g (45%)
            const proteinGrams = 158;
            const carbsGrams = 290;
            const fatsGrams = 90;

            const proteinCalories = proteinGrams * 4;
            const carbsCalories = carbsGrams * 4;
            const fatsCalories = fatsGrams * 9;
            const ctx = document.getElementById('macroChart').getContext('2d');
            if (macroChart) {
                macroChart.destroy();
            }
            macroChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: [`Protein (~${proteinGrams}g)`, `Carbs (~${carbsGrams}g)`, `Fats (~${fatsGrams}g)`],
                    datasets: [{
                        data: [proteinCalories, carbsCalories, fatsCalories],
                        backgroundColor: ['#4f46e5', '#34d399', '#f59e0b'],
                        borderColor: '#fff',
                        borderWidth: 4,
                        hoverOffset: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14,
                                }
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    if (context.parsed !== null) {
                                        const totalCalories = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = ((context.raw / totalCalories) * 100).toFixed(1);
                                        label += `${context.raw.toFixed(0)} kcal (${percentage}%)`;
                                    }
                                    return label;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // New function to wait for Chart.js to load before rendering the chart
        function initMacroChart() {
            const chartSkeleton = document.getElementById('chart-skeleton');
            const chartWrapper = document.getElementById('chart-wrapper');
            
            // 1. Check if the Chart global object is defined (meaning the deferred script has loaded)
            if (typeof Chart !== 'undefined') {
                // 2. Library loaded, create the chart
                _createChartInstance(); 
                
                // 3. Hide skeleton, show chart (smoother transition)
                if (chartSkeleton && chartWrapper) {
                    chartSkeleton.classList.add('hidden');
                    chartWrapper.classList.remove('hidden');
                }
            } else {
                // 4. Library not loaded yet (Polling): wait 50ms and check again
                if (chartSkeleton) {
                    chartSkeleton.classList.remove('hidden'); // Ensure skeleton is visible while waiting
                }
                setTimeout(initMacroChart, 50);
            }
        }

        function renderWeek(weekKey) {
            const weekData = dietPlanData.weeks[weekKey];
            mainContent.innerHTML = `
                <div class="content-fade-in">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">Diet Plan - Fat Loss</h2>
                    <h3 class="text-2xl font-semibold text-gray-700 mb-6">${weekData.title}</h3>
                    <p class="text-gray-600 mb-8">${weekData.focus}</p>
                    <div class="space-y-6">
                        ${weekData.meals.map(meal => {
                            if (meal.time.includes('Total Daily Intake')) {
                                return `
                                    <div class="bg-indigo-100 rounded-xl shadow-sm">
                                        <button class="collapsible-header w-full flex items-center justify-between p-6 focus:outline-none">
                                            <h3 class="text-xl font-bold text-indigo-800 flex items-center gap-3"><i class="${meal.icon}"></i> ${meal.time}</h3>
                                            <i class="fa-solid fa-chevron-down text-indigo-500"></i>
                                        </button>
                                        <div class="collapsible-content border-t border-indigo-300">
                                            <div class="p-6">
                                                <p class="font-medium text-indigo-800">${meal.item}</p>
                                                <p class="text-sm text-indigo-600 mt-2"><strong>Note:</strong> ${meal.micros}</p>
                                            </div>
                                        </div>
                                    </div>
                                `;
                            } else {
                                return `
                                    <div class="bg-white rounded-xl shadow-sm border-l-4 ${meal.color === 'bg-orange-100' ? 'border-orange-500' : (meal.color === 'bg-green-100' ? 'border-green-500' : 'border-blue-500')} p-6">
                                        <h3 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-3"><i class="${meal.icon} ${meal.color === 'bg-orange-100' ? 'text-orange-600' : (meal.color === 'bg-green-100' ? 'text-green-600' : 'text-blue-600')}"></i> ${meal.time}</h3>
                                        <div class="pl-4 border-l-2 border-gray-200 space-y-2">
                                            <ul class="list-disc list-inside space-y-2 text-gray-800">
                                                ${meal.items.map(item => `
                                                    <li>
                                                        <!-- FIX: Corrected markdown-style links -->
                                                        <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(item.link)}" target="_blank" class="text-indigo-600 hover:text-indigo-800 hover:underline">${item.name}</a>
                                                        <span class="text-gray-600 text-sm">- ${item.quantity}</span>
                                                    </li>
                                                `).join('')}
                                            </ul>
                                            ${meal.alternative ? `
                                            <div class="mt-2">
                                                <p class="font-medium text-gray-800">
                                                    <span class="text-red-500 text-lg mr-2">&bull;</span>
                                                    Alternative: ${meal.alternative}
                                                </p>
                                            </div>` : ''}
                                            <p class="text-sm text-gray-500 mt-4"><strong>Macros:</strong> ${meal.macros}</p>
                                            <p class="text-sm text-gray-500"><strong>Micros:</strong> ${meal.micros}</p>
                                        </div>
                                    </div>
                                `;
                            }
                        }).join('')}
                    </div>
                </div>
            `;
        }
        
        function renderKeyNotes() {
            const { client } = dietPlanData;
            mainContent.innerHTML = `
                <div class="content-fade-in">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Key Notes for Your Plan</h2>
                    
                    <!-- Nutritional Calculations -->
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-calculator text-blue-500 mr-3"></i> Nutritional Calculations
                        </h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>BMI:</strong> ${client.bmi} (Obese Class I  Fat loss is primary goal)</li>
                            <li><strong>BMR:</strong> ~${client.bmr.toFixed(0)} kcal/day</li>
                            <li><strong>TDEE:</strong> ~${client.tdee.toFixed(0)} kcal/day</li>
                            <li><strong>Target Calories (Fat Loss):</strong> ~${client.calorieTarget} kcal/day (~680 kcal deficit)</li>
                            <li><strong>Macro Split (New Target):</strong>
                                <ul class="list-disc list-inside ml-6 mt-1 space-y-1">
                                    <li>Protein (~158g): 24% (1.7g/kg to preserve muscle)</li>
                                    <li>Fat (~90g): 31% (For hormone health and satiety)</li>
                                    <li>Carbs (~290g): 45% (To fuel intense workouts)</li>
                                </ul>
                            </li>
                        </ul>
                    </div>

                    <!-- Dietary Guidelines -->
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-leaf text-green-500 mr-3"></i> Dietary Guidelines
                        </h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>Protein Sources:</strong> Chicken Breast, Fish, Eggs, Egg Whites, Paneer, Curd, Dals, Legumes.</li>
                            <li><strong>Carb Sources:</strong> Rice (Brown/Parboiled), Ragi, Jowar, Whole Wheat Roti, Oats, Sprouts.</li>
                            <li><strong>Fat Sources:</strong> Whole Eggs, Curd/Yogurt, Nuts, Coconut/Peanut Chutney, cooking oils (moderate).</li>
                            <li><strong>Vegetables:</strong> Daily inclusion is critical. Eat salads, stir-fries, and add to sambar/curries.</li>
                            <li><strong>Hydration:</strong> 3-4 L water/day (critically important for fat loss).</li>
                        </ul>
                    </div>
                    
                    <!-- Lifestyle & Training Notes -->
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-dumbbell text-purple-500 mr-3"></i> Lifestyle & Training Notes
                        </h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li><strong>Workout:</strong> Your 6-Day PPL split is intense. Do not skip warm-ups.</li>
                            <li><strong>Progressive Overload:</strong> This is the #1 key to success. You MUST aim to get stronger (more reps or more weight) each week.</li>
                            <li><strong>Sleep:</strong> Minimum 7-8 hrs/night. This is when your body burns fat and repairs muscle. It is not optional.</li>
                            <li><strong>Alcohol/Smoking:</strong> Minimize, as both slow fat loss, hurt recovery, and impact sleep quality.</li>
                        </ul>
                    </div>
                    
                    <!-- Practical Tips -->
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-utensils text-red-500 mr-3"></i> Practical Tips
                        </h3>
                        <ul class="list-disc list-inside space-y-2 text-gray-700">
                            <li>Prepare dosa/idli batter for 34 days in advance.</li>
                            <li>Cook rice/dal in bulk for 2 days.</li>
                            <li>Boil 6-8 eggs in the morning to use for the whole day.</li>
                            <li>Portion control is key. Measure your rice/chicken/oats until you can eyeball it accurately.</li>
                        </ul>
                    </div>
                </div>
            `;
        }
        
        function renderTrainingPlanSummary() {
            const { summary } = trainingPlanData;
            mainContent.innerHTML = `
                <div class="content-fade-in">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">${summary.title}</h2>
                    
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-key text-yellow-500 mr-3"></i> Key to Quick Results: ${summary.keyFocus}
                        </h3>
                        <p class="text-gray-700">${summary.keyFocusNote}</p>
                    </div>

                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
                        <h3 class="text-xl font-bold text-gray-800 mb-4">Workout Schedule</h3>
                        <div class="overflow-x-auto">
                            <table class="min-w-full divide-y divide-gray-200">
                                <thead class="bg-gray-50">
                                    <tr>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Day</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Workout Focus</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Goal</th>
                                        <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cardio</th>
                                    </tr>
                                </thead>
                                <tbody class="bg-white divide-y divide-gray-200">
                                    ${summary.schedule.map(day => `
                                        <tr class="${day.focus === 'REST' ? 'bg-gray-100' : ''}">
                                            <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">${day.day}</td>
                                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-700">${day.focus}</td>
                                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-700">${day.goal}</td>
                                            <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-700">${day.cardio}</td>
                                        </tr>
                                    `).join('')}
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="bg-yellow-100 p-6 rounded-xl shadow-sm border-l-4 border-yellow-500">
                        <h3 class="text-xl font-bold text-yellow-800 mb-2 flex items-center">
                            <i class="fa-solid fa-triangle-exclamation mr-3"></i> Recovery Note
                        </h3>
                        <p class="text-yellow-700">${trainingPlanData.recoveryNote}</p>
                    </div>
                </div>
            `;
        }

        function renderWorkoutDay(dayIndex) {
            const { detailedStructure } = trainingPlanData;
            const day = detailedStructure.days[dayIndex];
            
            mainContent.innerHTML = `
                <div class="content-fade-in">
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">${day.title}</h2>
                    <h3 class="text-2xl font-semibold text-indigo-600 mb-6">${day.dayName}</h3>
                    
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6">
                        <p class="text-gray-700"><strong>Sets:</strong> ${detailedStructure.sets}</p>
                        <p class="text-gray-700"><strong>Rest:</strong> ${detailedStructure.rest}</p>
                    </div>

                    <div class="workout-table-wrapper">
                        <span class="scroll-hint"><i class="fa-solid fa-arrows-left-right"></i> Scroll</span>
                        <table class="workout-table w-full divide-y divide-gray-200 shadow-sm border border-gray-200 rounded-lg overflow-hidden">
                            <thead class="bg-gray-50">
                                <tr>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Exercise</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Sets  Reps</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Focus</th>
                                    <th class="px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Note</th>
                                </tr>
                            </thead>
                            <tbody class="bg-white divide-y divide-gray-200">
                                ${day.exercises.map(ex => `
                                    <tr>
                                        <td class="px-4 py-4 whitespace-nowrap text-sm font-medium text-gray-900">
                                            <!-- FIX: Corrected markdown-style links -->
                                            <a href="https://www.youtube.com/results?search_query=${encodeURIComponent(ex.name + ' exercise tutorial')}" target="_blank" class="text-indigo-600 hover:text-indigo-800 hover:underline">
                                                ${ex.name}
                                            </a>
                                        </td>
                                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-700">${ex.sets}  ${ex.reps}</td>
                                        <td class="px-4 py-4 whitespace-nowrap text-sm text-gray-700">${ex.focus}</td>
                                        <td class="px-4 py-4 whitespace-normal text-sm text-gray-500 min-w-[200px]">${ex.note}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                    </div>
                </div>
            `;
        }

        function renderExplore() {
            mainContent.innerHTML = `
                <div class="content-fade-in">
                    <!-- FIX: Corrected markdown-style links -->
                    <h2 class="text-3xl font-bold text-gray-900 mb-2">Thank you for choosing <a href="https://kn0x-fit.com/" target="_blank" class="text-red-500 hover:underline">KN0X-FIT</a>!</h2>
                    <p class="text-gray-600 mb-8">Your transformation journey begins now, and we're thrilled to be a part of your path to a healthier, stronger, and more confident you. Whether you're a seasoned athlete or just starting out, our program is designed to support you every step of the way.</p>

                    <h3 class="text-2xl font-bold text-gray-900 mb-6">Here are other plans that you can choose:</h3>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
                        <!-- Plan 1 -->
                        <div class="bg-blue-50 p-6 rounded-xl shadow-sm flex flex-col items-center text-center border-t-4 border-blue-500">
                            <i class="fa-solid fa-dumbbell text-4xl text-blue-500 mb-4"></i>
                            <h4 class="text-xl font-bold text-blue-600">Workout Plan</h4>
                            <p class="text-sm text-gray-500 mt-2 text-left">Comprehensive workout plan designed for building muscle with professional guidance.</p>
                            <ul class="list-disc list-inside text-gray-700 text-left mt-4 space-y-2 w-full">
                                <li>Specialized workout routine</li>
                                <li>Progressive training plan</li>
                                <li>Assigned to your goals</li>
                                <li>Tailored to fitness level</li>
                                <li>One session with expert trainer</li>
                            </ul>
                            <p class="text-2xl font-bold mt-4"><span class="text-base font-normal line-through text-gray-500">2000</span> 799<span class="text-base font-normal">/month</span></p>
                        </div>
                        <!-- Plan 2 -->
                        <div class="bg-green-50 p-6 rounded-xl shadow-lg flex flex-col items-center text-center border-t-4 border-green-500 transform transition-transform duration-300 lg:scale-105">
                            <i class="fa-solid fa-star text-4xl text-green-500 mb-4"></i>
                            <h4 class="text-xl font-bold text-green-600">Total Transformation</h4>
                            <p class="text-sm text-gray-500 mt-2 text-left">Complete diet and workout plan with weekly trainer consultation and daily follow-ups.</p>
                            <ul class="list-disc list-inside text-gray-700 text-left mt-4 space-y-2 w-full">
                                <li>Personalised diet & workout combined plan</li>
                                <li>Assigned to your goals</li>
                                <li>Weekly trainer sessions</li>
                                <li>Daily follow-up support</li>
                                <li>Royalty program eligible</li>
                                <li>Get 1 month FREE with daily updates</li>
                            </ul>
                            <p class="text-2xl font-bold mt-4"><span class="text-base font-normal line-through text-gray-500">5000</span> 3499<span class="text-base font-normal">/month</span></p>
                        </div>
                        <!-- Plan 3 -->
                        <div class="bg-orange-50 p-6 rounded-xl shadow-sm flex flex-col items-center text-center border-t-4 border-orange-500">
                            <i class="fa-solid fa-running text-4xl text-orange-500 mb-4"></i>
                            <h4 class="text-xl font-bold text-orange-600">General Fitness</h4>
                            <p class="text-sm text-gray-500 mt-2 text-left">Balanced diet and workout plan with one trainer session to kickstart your fitness journey.</p>
                            <ul class="list-disc list-inside text-gray-700 text-left mt-4 space-y-2 w-full">
                                <li>Balanced diet plan</li>
                                <li>Basic workout routine</li>
                                <li>One trainer consultation</li>
                                <li>BMI report included</li>
                                <li>Sustainable approach</li>
                            </ul>
                            <p class="text-2xl font-bold mt-4"><span class="text-base font-normal line-through text-gray-500">2000</span> 999<span class="text-base font-normal">/month</span></p>
                        </div>
                    </div>

                    <div class="text-center mt-12">
                        <!-- FIX: Corrected markdown-style links -->
                        <a href="https://kn0x-fit.com/" target="_blank" class="text-gray-600 mb-6 font-semibold inline-block text-lg text-red-500 hover:underline transition-colors">KN0X-FIT - Built for Change, Designed for You</a>
                        <div class="flex flex-col sm:flex-row justify-center items-center gap-6 mt-4">
                            <!-- WhatsApp -->
                            <!-- FIX: Corrected markdown-style links -->
                            <a href="https://wa.me/919380422603" target="_blank" class="flex items-center gap-2 text-gray-600 hover:text-green-500 transition-colors">
                                <i class="fa-brands fa-whatsapp text-3xl" style="color: #25D366;"></i>
                                <span>+91 9380422603</span>
                            </a>
                            <!-- Email -->
                            <a href="mailto:info@kn0x-fit.com" class="flex items-center gap-2 text-gray-600 hover:text-blue-500 transition-colors">
                                <i class="fa-solid fa-envelope text-3xl" style="color: #0072C6;"></i>
                                <span>info@kn0x-fit.com</span>
                            </a>
                            <!-- Instagram -->
                            <!-- FIX: Corrected markdown-style links -->
                            <a href="https://www.instagram.com/kn0x_fit/profilecard/?igsh=bWFiMzlkanppYTh1" target="_blank" class="flex items-center gap-2 text-gray-600 hover:text-purple-600 transition-colors">
                                <i class="fa-brands fa-instagram text-3xl" style="background: radial-gradient(circle at 30% 107%, #fdf497 0%, #fdf4f7 5%, #fd5949 45%, #d6249f 60%, #285AEB 90%);-webkit-background-clip: text; -webkit-text-fill-color: transparent;"></i>
                                <span>@KN0X_FIT</span>
                            </a>
                        </div>
                    </div>
                </div>
            `;
        }

        function renderTerms() {
            mainContent.innerHTML = `
                <div class="content-fade-in">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6">Terms & Conditions</h2>
                    
                    <div class="bg-white p-6 rounded-xl shadow-sm mb-6 space-y-4 text-gray-700">
                        <h3 class="text-xl font-bold text-gray-800 mb-4 flex items-center">
                            <i class="fa-solid fa-box-open text-blue-500 mr-3"></i> 1. Program Inclusions
                        </h3>
                        <p>Depending on the package you choose, the following services are provided:</p>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li><strong>Diet Plan:</strong> Customized weekly diet plan based on your preferences, goals, and budget constraints.</li>
                            <li><strong>Workout Plan:</strong> Progressive gym/home workout routines tailored to your fitness level and equipment availability.</li>
                            <li><strong>Combo Plan:</strong> Complete package including both personalized diet and workout plans for comprehensive results.</li>
                            <li><strong>Elite Program:</strong> Premium coaching with daily follow-up and weekly trainer consultation for maximum results.</li>
                            <li><strong>Elite Program Bonus:</strong> 1 extra month FREE if all terms and daily update requirements are met throughout your program.</li>
                        </ul>
                        <p class="font-semibold">Focus on Experience & Results: Backed by years of practical experience and real client transformations, we specialize in proven training methods that deliver results. Our expertise comes from hands-on coaching and helping clients achieve lasting change.</p>

                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-calendar-check text-green-500 mr-3"></i> 2. Duration
                        </h3>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li>All standard plans are valid for <strong>1 month (30 days)</strong> from the date of plan delivery.</li>
                            <li>Free month in Elite Plan applies only if all daily updates are submitted as per requirements.</li>
                            <li>Program extensions may be granted in case of technical issues or delays on our side.</li>
                        </ul>
                        
                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-mobile-screen-button text-indigo-500 mr-3"></i> 3. Daily Follow-up & Check-in (Elite Clients Only)
                        </h3>
                        <p class="font-semibold">Required Daily Updates: Elite clients are required to send daily updates including the following:</p>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li><strong>Visual Updates:</strong> Meal Photos (all major meals) and Workout Summary.</li>
                            <li><strong>Tracking Data:</strong> Steps or Activity Level, Water Intake.</li>
                            <li><strong>Feedback:</strong> Any issues or questions.</li>
                        </ul>
                        <p class="font-semibold">Timing Requirements:</p>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li>Updates must be sent <strong>once every 24 hours</strong>.</li>
                            <li>Preferably submitted <strong>before 11 PM daily</strong>.</li>
                        </ul>

                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-gavel text-red-500 mr-3"></i> 4. 3-Strike Policy
                        </h3>
                        <p>This policy ensures program effectiveness and qualifies you for the FREE Elite month bonus.</p>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li>You are allowed <strong>3 days of missed updates</strong> during the entire program duration.</li>
                            <li>Missing the <strong>4th day revokes your eligibility</strong> for the 1-month FREE Elite Program.</li>
                            <li>No warnings will be sentthis is tracked automatically by our system.</li>
                        </ul>
                        
                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-ban text-orange-500 mr-3"></i> 5. Refund Policy
                        </h3>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li><strong>No Refunds After:</strong> Plan is purchased, payment is processed, questionnaire is shared, or custom plans are delivered.</li>
                            <li>Plans are created manually and personalized, making the process non-reversible.</li>
                            <li><strong>Exceptions & Extensions:</strong> Technical issues on our platform, significant delays in plan delivery, or errors on our side.</li>
                        </ul>

                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-paper-plane text-cyan-500 mr-3"></i> 6. Plan Delivery
                        </h3>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li><strong>First plan delivery:</strong> Within 2448 hours of payment and questionnaire completion.</li>
                            <li><strong>Plan updates:</strong> Weekly revisions as included in your package.</li>
                            <li><strong>Communication:</strong> Primary channels are WhatsApp and email.</li>
                        </ul>

                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-arrows-rotate text-purple-500 mr-3"></i> 7. Support & Revisions
                        </h3>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li><strong>Regular Revisions:</strong> Weekly revision included (only one per week) based on progress.</li>
                            <li><strong>Emergency Adjustments:</strong> For allergy discoveries, illness, or injury, subject to trainer's discretion.</li>
                        </ul>

                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-shield-halved text-gray-700 mr-3"></i> 8. Confidentiality & Data
                        </h3>
                        <p>All client data is kept strictly confidential and only used for internal coaching purposes.</p>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li>Personal information is never shared with third parties.</li>
                            <li>Progress photos will not be shared publicly without your written consent.</li>
                        </ul>
                        
                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-camera-retro text-pink-500 mr-3"></i> 9. Transformation Use
                        </h3>
                        <p>If you complete the program successfully, you may be asked to share transformation photos for marketing and testimonials.</p>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li>You have the <strong>absolute right to decline</strong>.</li>
                            <li>If agreed, your progress will be featured with proper credit.</li>
                        </ul>

                        <h3 class="text-xl font-bold text-gray-800 mb-4 pt-4 border-t">
                            <i class="fa-solid fa-scale-balanced text-teal-500 mr-3"></i> 10. Results Disclaimer
                        </h3>
                        <p>Results vary per individual based on commitment, lifestyle, and health conditions.</p>
                        <ul class="list-disc list-inside space-y-2 pl-4">
                            <li><strong>We Provide:</strong> Scientifically-backed meal plans, progressive workout routines, and expert coaching.</li>
                            <li><strong>Success Depends On:</strong> Your consistency, adherence to the plans, regular communication, and lifestyle factors.</li>
                        </ul>
                        
                        <!-- Limitation of Liability -->
                        <div class="bg-red-100 p-6 rounded-xl shadow-sm border-l-4 border-red-500 mt-6">
                            <h3 class="text-xl font-bold text-red-800 mb-4 flex items-center">
                                <i class="fa-solid fa-triangle-exclamation text-red-600 mr-3"></i> Limitation of Liability & Medical Disclaimer
                            </h3>
                            <p class="text-red-700 font-semibold">
                                By using this plan, you acknowledge that KN0X-FIT and its coaches are not medical professionals. The diet and workout plans provided are for informational and educational purposes only and do not constitute medical advice.
                            </p>
                            <p class="text-red-700 mt-2">
                                You should consult with your physician or other qualified health-care professional before starting any new diet or exercise program. We are not responsible or liable for any kind of health issue, injury, or any other problem that may arise from following our plan. You are participating at your own risk.
                            </p>
                        </div>
                    </div>
                </div>
            `;
        }
        
        mainContent.addEventListener('click', (e) => {
            const header = e.target.closest('.collapsible-header');
            if (header) {
                const content = header.nextElementSibling;
                header.classList.toggle('expanded');
                content.classList.toggle('expanded');
            }
        });

        // Sidebar Navigation Logic
        navigation.addEventListener('click', (e) => {
            e.preventDefault();
            
            const link = e.target.closest('a.nav-link, button.nav-link');
            if (!link) return; // Clicked outside a link

            // Handle Training Plan Toggle
            if (link.id === 'training-plan-toggle') {
                trainingPlanSubmenu.classList.toggle('expanded');
                link.querySelector('i.fa-chevron-down').classList.toggle('rotate-180');
                return; // Don't navigate, just toggle
            }
            
            const view = link.dataset.view;
            if (view) {
                // Scroll to top on new page view
                window.scrollTo(0, 0);
                
                if (view.startsWith('training-day-')) {
                    const dayIndex = parseInt(view.split('-')[2]);
                    renderWorkoutDay(dayIndex);
                } else if (view === 'training-summary') {
                    renderTrainingPlanSummary();
                } else if (view === 'dashboard') {
                    renderDashboard();
                } else if (view === 'explore') {
                    renderExplore();
                } else if (view === 'keyNotes') {
                    renderKeyNotes();
                } else if (view === 'terms') {
                    renderTerms();
                } else if (view.startsWith('week')) {
                    renderWeek(view);
                }
                
                setActiveLink(view);
                closeMobileMenu();
            }
        });

        // Mobile Menu Toggling
        menuToggle.addEventListener('click', (e) => {
            e.stopPropagation();
            sidebar.classList.remove('-translate-x-full');
            sidebar.classList.add('translate-x-0'); // Explicitly open
            overlay.classList.remove('hidden');
        });

        overlay.addEventListener('click', () => {
            closeMobileMenu();
        });

        function closeMobileMenu() {
            sidebar.classList.add('-translate-x-full');
            sidebar.classList.remove('translate-x-0'); // Explicitly close
            overlay.classList.add('hidden');
        }

        function setActiveLink(view) {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            const activeLink = document.querySelector(`.nav-link[data-view="${view}"]`);
            if (activeLink) {
                activeLink.classList.add('active');

                // Open training submenu if a child is active
                if (view.startsWith('training-')) {
                    trainingPlanSubmenu.classList.add('expanded');
                    trainingPlanToggle.classList.add('active'); // Also highlight the parent
                    trainingPlanToggle.querySelector('i.fa-chevron-down').classList.add('rotate-180');
                } else {
                    // Close training submenu if a main link is clicked
                    trainingPlanSubmenu.classList.remove('expanded');
                    trainingPlanToggle.classList.remove('active');
                    trainingPlanToggle.querySelector('i.fa-chevron-down').classList.remove('rotate-180');
                }
            }
        }

        // Initial Load
        // SPEED OPTIMIZATION: Use DOMContentLoaded to ensure all deferred scripts are loaded
        document.addEventListener('DOMContentLoaded', () => {
            setActiveLink('dashboard');
            renderDashboard();
        });

    </script>
</body>
</html>
